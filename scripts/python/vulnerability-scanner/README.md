# üõ°Ô∏è SHADOW - Vulnerability Scanner

An advanced Python-based vulnerability scanner that uses YAML templates to detect security issues in web applications and network services.

## ‚ú® Features

- **Template-Based Scanning**: Uses YAML templates for flexible vulnerability detection
- **Multi-Target Support**: Scan single hosts, IP ranges, or bulk targets from files
- **Async Scanning**: High-performance asynchronous HTTP requests
- **DNS Enumeration**: Built-in DNS record checking capabilities
- **Multiple Output Formats**: Text and JSON report formats
- **Severity Classification**: Categorizes vulnerabilities by severity level
- **Extensible**: Easy to add new vulnerability templates

## üìã Requirements

\`\`\`bash
pip install pyyaml requests dnspython aiohttp
\`\`\`

## üöÄ Quick Start

### Basic Usage

\`\`\`bash
# Scan a single target
python shadow.py -t example.com

# Scan multiple targets
python shadow.py -t example.com google.com 192.168.1.1

# Scan from file
python shadow.py -f targets.txt

# Generate JSON report
python shadow.py -t example.com --format json
\`\`\`

### Advanced Usage

\`\`\`bash
# Custom templates directory
python shadow.py -t example.com --templates ./custom-templates

# Custom output directory
python shadow.py -t example.com --output ./scan-results

# Verbose mode
python shadow.py -t example.com -v

# Don't save report to file
python shadow.py -t example.com --no-save
\`\`\`

## üìÅ Directory Structure

\`\`\`
vulnerability-scanner/
‚îú‚îÄ‚îÄ shadow.py              # Main scanner script
‚îú‚îÄ‚îÄ templates/             # Vulnerability templates
‚îÇ   ‚îú‚îÄ‚îÄ sample-template.yaml
‚îÇ   ‚îî‚îÄ‚îÄ custom-checks.yaml
‚îú‚îÄ‚îÄ reports/              # Generated reports
‚îî‚îÄ‚îÄ README.md            # This file
\`\`\`

## üìù Template Format

SHADOW uses YAML templates to define vulnerability checks:

\`\`\`yaml
id: 'directory-listing-check'
info:
  name: 'Directory Listing Enabled'
  author: 'Security Team'
  severity: 'medium'
  description: 'Detects servers with directory listing enabled'
  tags: ['directory-listing', 'information-disclosure']

requests:
  - method: 'GET'
    path: '/'
    headers:
      User-Agent: 'SHADOW-Scanner/1.0'
    expected:
      - status: 200
        body_contains: 'Index of /'

dns:
  - type: 'A'
  - type: 'MX'
\`\`\`

### Template Components

| Component | Description | Required |
|-----------|-------------|----------|
| `id` | Unique template identifier | Yes |
| `info` | Template metadata (name, severity, etc.) | Yes |
| `requests` | HTTP request definitions | Optional |
| `dns` | DNS check definitions | Optional |

## üéØ Target Input Formats

### Command Line Targets
\`\`\`bash
# Single domain
python shadow.py -t example.com

# Multiple targets
python shadow.py -t example.com 192.168.1.1 subdomain.example.org

# IP range (CIDR)
python shadow.py -t 192.168.1.0/24
\`\`\`

### File Input
Create a text file with one target per line:

\`\`\`
example.com
192.168.1.1
subdomain.example.org
# Comments are ignored
*.example.com
192.168.1.0/24
\`\`\`

YAML format is also supported:
\`\`\`yaml
- example.com
- 192.168.1.1
- subdomain.example.org
\`\`\`

## üìä Report Formats

### Text Report
\`\`\`
============================================================
SHADOW VULNERABILITY SCAN REPORT
============================================================
Scan Date: 2024-01-15 14:30:22
Total Checks: 15
Vulnerabilities Found: 3

HIGH SEVERITY VULNERABILITIES:
----------------------------------------
Template: SQL Injection Detection
URL: http://example.com/login
Description: Potential SQL injection vulnerability
Status Code: 200
\`\`\`

### JSON Report
\`\`\`json
{
  "scan_info": {
    "timestamp": "2024-01-15T14:30:22",
    "total_checks": 15,
    "vulnerabilities_found": 3
  },
  "results": [
    {
      "template_id": "sql-injection-check",
      "template_name": "SQL Injection Detection",
      "severity": "high",
      "url": "http://example.com/login",
      "status": "vulnerable"
    }
  ]
}
\`\`\`

## üîß Command Line Options

| Option | Description | Default |
|--------|-------------|---------|
| `-t, --targets` | Target URLs or IPs | None |
| `-f, --file` | File containing targets | None |
| `--templates` | Templates directory | ./templates |
| `--output` | Output directory | ./reports |
| `--format` | Output format (text/json) | text |
| `--no-save` | Don't save report to file | False |
| `-v, --verbose` | Verbose output | False |

## üõ† Creating Custom Templates

### HTTP Request Template
\`\`\`yaml
id: 'custom-admin-panel'
info:
  name: 'Admin Panel Detection'
  severity: 'medium'
  description: 'Detects exposed admin panels'
  
requests:
  - method: 'GET'
    path: '/admin'
    expected:
      - status: 200
        body_contains: 'admin login'
  - method: 'GET'
    path: '/administrator'
    expected:
      - status: 200
\`\`\`

### DNS Enumeration Template
\`\`\`yaml
id: 'dns-enumeration'
info:
  name: 'DNS Record Enumeration'
  severity: 'info'
  description: 'Enumerates DNS records'
  
dns:
  - type: 'A'
  - type: 'AAAA'
  - type: 'MX'
  - type: 'TXT'
  - type: 'CNAME'
\`\`\`

## üîí Security Considerations

- **Authorization**: Only scan systems you own or have explicit permission to test
- **Rate Limiting**: The scanner includes built-in delays to avoid overwhelming targets
- **Legal Compliance**: Ensure compliance with local laws and regulations
- **Responsible Disclosure**: Report vulnerabilities through appropriate channels

## üêõ Troubleshooting

### Common Issues

**No Templates Found**
\`\`\`bash
# Check templates directory exists
ls -la ./templates/

# Create sample template
python shadow.py -t example.com  # Auto-creates sample template
\`\`\`

**Connection Timeouts**
\`\`\`bash
# Increase timeout in the code or reduce concurrent requests
# Edit the timeout value in aiohttp.ClientTimeout()
\`\`\`

**DNS Resolution Errors**
\`\`\`bash
# Check DNS configuration
nslookup example.com

# Use IP addresses instead of domains
python shadow.py -t 192.168.1.1
\`\`\`

## üìà Performance Optimization

- **Concurrent Requests**: Uses asyncio for high-performance scanning
- **Template Caching**: Templates are loaded once and reused
- **Memory Efficient**: Streams responses to avoid memory issues
- **Timeout Management**: Configurable timeouts prevent hanging requests

## ü§ù Contributing

### Adding New Templates
1. Create YAML file in `templates/` directory
2. Follow the template format specification
3. Test with known vulnerable/safe targets
4. Document the vulnerability type and detection method

### Code Contributions
- Follow Python PEP 8 style guidelines
- Add comprehensive error handling
- Include unit tests for new features
- Update documentation

## üìÑ License

This tool is provided for educational and authorized security testing purposes only. Users are responsible for compliance with applicable laws and regulations.

## üîó Related Tools

- **Nuclei**: Template-based vulnerability scanner
- **Nmap**: Network discovery and security auditing
- **OWASP ZAP**: Web application security scanner
- **Burp Suite**: Web vulnerability scanner
